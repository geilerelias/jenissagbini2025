import{l,f as g,o as u,b as s,w as o,a as h,i as a,t as x,c as _,h as y,e as W,F as j,j as G,C as J}from"./app-BOimrL6G.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";const H={props:{initial:{type:Boolean,default:!1}},data:function(){return{size:{width:-1,height:-1}}},methods:{reset:function(){var t=this.$el.firstChild,e=this.$el.lastChild;t.scrollLeft=1e5,t.scrollTop=1e5,e.scrollLeft=1e5,e.scrollTop=1e5},update:function(){this.size.width=this.$el.offsetWidth,this.size.height=this.$el.offsetHeight}},watch:{size:{deep:!0,handler:function(t){this.reset(),this.$emit("resize",{width:this.size.width,height:this.size.height})}}},render:function(t){var e="position: absolute; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;",d="position: absolute; left: 0; top: 0;";return t("div",{style:e+"animation-name: resizeSensorVisibility;",on:{"~animationstart":this.update}},[t("div",{style:e,on:{scroll:this.update}},[t("div",{style:d+"width: 100000px; height: 100000px;"})]),t("div",{style:e,on:{scroll:this.update}},[t("div",{style:d+"width: 200%; height: 200%;"})])])},beforeDestroy:function(){this.$emit("resize",{width:0,height:0}),this.$emit("resizeSensorBeforeDestroy")},mounted:function(){if(this.initial===!0&&this.$nextTick(this.update),this.$el.offsetParent!==this.$el.parentNode&&(this.$el.parentNode.style.position="relative"),"attachEvent"in this.$el&&!("AnimationEvent"in window)){var t=(function(){this.update(),e()}).bind(this),e=(function(){this.$el.detachEvent("onresize",t),this.$off("resizeSensorBeforeDestroy",e)}).bind(this);this.$el.attachEvent("onresize",t),this.$on("resizeSensorBeforeDestroy",e),this.reset()}}};function A(t){var e=t.createLoadingTask,d=t.PDFJSWrapper;return{createLoadingTask:e,render:function(r){return r("span",{attrs:{style:"position: relative; display: block"}},[r("canvas",{attrs:{style:"display: inline-block; width: 100%; height: 100%; vertical-align: top"},ref:"canvas"}),r("span",{style:"display: inline-block; width: 100%; height: 100%",class:"annotationLayer",ref:"annotationLayer"}),r(H,{props:{initial:!0},on:{resize:this.resize}})])},props:{src:{type:[String,Object,Uint8Array],default:""},page:{type:Number,default:1},rotate:{type:Number}},watch:{src:function(){this.pdf.loadDocument(this.src)},page:function(){this.pdf.loadPage(this.page,this.rotate)},rotate:function(){this.pdf.renderPage(this.rotate)}},methods:{resize:function(r){if(!(this.$el.parentNode===null||r.width===0&&r.height===0)){this.$refs.canvas.style.height=this.$refs.canvas.offsetWidth*(this.$refs.canvas.height/this.$refs.canvas.width)+"px";var i=this.pdf.getResolutionScale();(i<.85||i>1.15)&&this.pdf.renderPage(this.rotate)}},print:function(r,i){this.pdf.printPage(r,i)}},mounted:function(){this.pdf=new d(this.$refs.canvas,this.$refs.annotationLayer,this.$emit.bind(this)),this.$on("loaded",function(){this.pdf.loadPage(this.page,this.rotate)}),this.$on("page-size",function(r,i){this.$refs.canvas.style.height=this.$refs.canvas.offsetWidth*(i/r)+"px"}),this.pdf.loadDocument(this.src)},destroyed:function(){this.pdf.destroy()}}}var K={};if(K.VUE_ENV!=="server"){var Q=require("./pdfjsWrapper.js").default,k=require("pdfjs-dist/es5/build/pdf.js");if(typeof window<"u"&&"Worker"in window&&navigator.appVersion.indexOf("MSIE 10")===-1){var X=require("worker-loader!pdfjs-dist/es5/build/pdf.worker.js");k.GlobalWorkerOptions.workerPort=new X}var C=A(Q(k))}else var C=A({});const v=C,Y={components:{pdf:v},props:["formTitle","editedIndex","editedItem","idItem"],data(){return{isActive:!1,loaded:!1,src:"",file:null,fileUrl:null,show:!0,numPages:0,rotate:0,valid:!0,titleRules:[t=>!!t||"Titulo es requerido"],descriptionRules:[t=>!!t||"Descripción es requerida"],fileRules:[t=>!!t||"El archivo es requerido"],lazy:!1,indexArticle:-1,editedArticle:{id:"",title:"",description:"",file:null},defaultItem:{id:"",title:"",description:"",file:null}}},computed:{doubleScore(){return this.score*2}},beforeUpdate:function(){console.log("Empieza un nuevo renderizado de component"),this.editedArticle=this.editedItem,console.log("this is edited article: ",this.editedArticle),console.log("this is file: ",this.file," this is index: ",this.editedIndex),this.editedIndex>0&&this.file===null&&(console.log("soy mayor"),console.log("edit file: ",this.editedArticle.file),this.viewDocument=!0,this.src=v.createLoadingTask("/storage/"+this.editedArticle.file),this.src.then(t=>{this.numPages=t.numPages}),this.viewDocument=!0)},methods:{handleFileUpload(){this.viewDocument=!1,this.editedArticle.file=this.file,console.log(this.editedArticle.file)},onLoad(){this.loaded=!0,console.log("lo hace")},Change(){let t=new FileReader;t.onload=()=>{this.fileUrl=t.result},console.log(t.readAsDataURL(this.editedArticle.file))},onUpload(){const t=new FileReader;console.log(this.editedIndex),this.editedIndex>0&&this.file===null?(console.log("soy mayor"),console.log("edit file: ",this.editedArticle.file),this.viewDocument=!0,this.src=v.createLoadingTask("/pdf/"+this.editedArticle.file),this.src.then(e=>{this.numPages=e.numPages})):this.file!==null?(this.viewDocument=!0,t.readAsDataURL(this.file),t.addEventListener("load",()=>{this.src=v.createLoadingTask(t.result),this.src.then(e=>{this.numPages=e.numPages})})):Swal.fire("Archivo vacío!","No has elegido ningún archivo.","error")},password:function(t,e){t(prompt('password is "test"'))},error:function(t){console.log(t)},save(){if(this.validate())if(this.editedIndex>-1)this.edit();else{let t=new FormData;t.append("title",this.editedArticle.title),t.append("description",this.editedArticle.description),t.append("file",this.editedArticle.file),console.log(t),axios.post("/api/othersArticle",t).then(e=>{const d=e.data;this.$emit("addOthersArticles",d),Swal.fire("Buen trabajo! 😃","Registro Exitoso! ","success")}).catch(e=>{console.error(e)}),this.close()}else Swal.fire({type:"error",title:"Oops...",text:"Campos no validados!"})},edit(){const t=this.editedArticle;this.editedIndex;let e=new FormData;e.append("title",this.editedArticle.title),e.append("description",this.editedArticle.description),e.append("file",this.editedArticle.file),axios.post(`/api/othersArticle/update/${this.idItem}`,e).then(d=>{this.$emit("updateArrayOfOthersArticles",t),Swal.fire("Buen trabajo!","Editado correctamente!","success"),this.close()}).catch(d=>{Swal.fire({type:"error",title:"Oops...",text:"Algo salió mal!"})})},validate(){return this.$refs.form.validate()?!0:(console.log("fallo la validación"),!1)},reset(){this.$refs.form.reset()},resetValidation(){this.$refs.form.resetValidation()},close(){this.$emit("closeDialog",!1),setTimeout(()=>{this.editedArticle=Object.assign({},this.defaultItem),this.file=this.defaultItem.file,this.$emit("editedItem",this.editedArticle),this.indexArticle=-1,this.$emit("editedIndex",this.indexArticle),this.reset()},300)}}};function Z(t,e,d,r,i,c){const p=l("v-icon"),f=l("v-btn"),w=l("v-toolbar-title"),D=l("v-toolbar-items"),b=l("v-toolbar"),z=l("v-text-field"),m=l("v-col"),V=l("v-textarea"),P=l("v-file-input"),L=l("v-spacer"),S=l("v-avatar"),I=l("v-chip"),U=l("v-divider"),T=l("v-progress-circular"),R=l("pdf"),$=l("v-sheet"),E=l("v-card"),N=l("v-row"),B=l("v-form"),F=l("v-container"),O=l("v-card-text"),q=l("v-card-actions");return u(),g("div",null,[s(b,{dark:"",style:{"border-radius":"0"}},{default:o(()=>[s(f,{icon:"",dark:"",onClick:e[0]||(e[0]=n=>c.close())},{default:o(()=>[s(p,null,{default:o(()=>e[8]||(e[8]=[a("mdi-close")])),_:1})]),_:1}),s(w,{class:"headline"},{default:o(()=>[a(x(d.formTitle),1)]),_:1}),e[10]||(e[10]=h("div",{class:"flex-grow-1"},null,-1)),s(D,null,{default:o(()=>[s(f,{text:"",disabled:!i.valid,class:"mr-4",onClick:c.validate},{default:o(()=>e[9]||(e[9]=[a(" Registrar ")])),_:1},8,["disabled","onClick"])]),_:1})]),_:1}),s(O,null,{default:o(()=>[s(F,{fluid:""},{default:o(()=>[s(B,{ref:"form",modelValue:i.valid,"onUpdate:modelValue":e[7]||(e[7]=n=>i.valid=n),"lazy-validation":i.lazy,enctype:"multipart/form-data"},{default:o(()=>[s(N,null,{default:o(()=>[s(m,{cols:"12",sm:"6",md:"4"},{default:o(()=>[s(z,{clearable:"",modelValue:i.editedArticle.title,"onUpdate:modelValue":e[1]||(e[1]=n=>i.editedArticle.title=n),rules:i.titleRules,label:"Titulo","prepend-icon":"mdi-format-title",required:""},null,8,["modelValue","rules"])]),_:1}),s(m,{cols:"12"},{default:o(()=>[s(V,{clearable:"",modelValue:i.editedArticle.description,"onUpdate:modelValue":e[2]||(e[2]=n=>i.editedArticle.description=n),rules:i.descriptionRules,label:"Descripción","prepend-icon":"mdi-text"},null,8,["modelValue","rules"])]),_:1}),s(m,{cols:"12"},{default:o(()=>[s(P,{ref:"file",modelValue:i.file,"onUpdate:modelValue":e[3]||(e[3]=n=>i.file=n),rules:i.fileRules,accept:".pdf",label:"Seleccione un archivo","single-line":"",onChange:e[4]||(e[4]=n=>c.handleFileUpload())},null,8,["modelValue","rules"])]),_:1}),s(m,{cols:"12"},{default:o(()=>[i.file!==null&&i.file!==void 0?(u(),_(E,{key:0,class:"mx-auto","max-width":"700"},{default:o(()=>[s(b,null,{default:o(()=>[s(w,{"primary-title":""},{default:o(()=>e[11]||(e[11]=[a(" Gestión de archivos ")])),_:1}),s(L),s(f,{icon:"",onClick:c.onUpload},{default:o(()=>[s(p,null,{default:o(()=>e[12]||(e[12]=[a("mdi-file-eye")])),_:1})]),_:1},8,["onClick"]),h("button",{icon:"",onClick:e[5]||(e[5]=n=>i.rotate-=90)},[s(p,null,{default:o(()=>e[13]||(e[13]=[a("mdi-rotate-left")])),_:1})]),h("button",{icon:"",onClick:e[6]||(e[6]=n=>i.rotate+=90)},[s(p,null,{default:o(()=>e[14]||(e[14]=[a("mdi-rotate-right")])),_:1})]),t.$vuetify.breakpoint.smAndUp&&i.numPages!=0?(u(),_(I,{key:0},{default:o(()=>[s(S,{left:"",class:"grey lighten-1"},{default:o(()=>[a(x(i.numPages),1)]),_:1}),e[15]||(e[15]=a(" Páginas "))]),_:1})):y("",!0)]),_:1}),s(U),!i.loaded&&t.viewDocument?(u(),_(T,{key:0,size:50,color:"success",indeterminate:""})):y("",!0),W(s($,{class:"pa-12",color:"grey lighten-3",style:{height:"500px",overflow:"scroll"}},{default:o(()=>[(u(!0),g(j,null,G(i.numPages,n=>(u(),g("div",{key:n,class:"d-flex justify-center mb-6"},[s(R,{ref_for:!0,ref:"myPdf",class:"elevation-15 pa-0 ma-0",src:i.src,page:n,onLoaded:c.onLoad,rotate:i.rotate,transition:"fade-transition"},null,8,["src","page","onLoaded","rotate"]),e[16]||(e[16]=h("p",null,null,-1))]))),128))]),_:1},512),[[J,i.loaded]])]),_:1})):y("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue","lazy-validation"])]),_:1})]),_:1}),s(q,null,{default:o(()=>[e[20]||(e[20]=h("div",{class:"flex-grow-1"},null,-1)),s(f,{color:"warning ",class:"mr-4",onClick:c.close},{default:o(()=>e[17]||(e[17]=[a(" Cancelar ")])),_:1},8,["onClick"]),s(f,{color:"error ",class:"mr-4",onClick:c.reset},{default:o(()=>e[18]||(e[18]=[a(" Reiniciar ")])),_:1},8,["onClick"]),s(f,{disabled:!i.valid,color:"success ",class:"mr-4",onClick:c.save},{default:o(()=>e[19]||(e[19]=[a(" Guardar ")])),_:1},8,["disabled","onClick"])]),_:1})])}const ie=M(Y,[["render",Z]]);export{ie as default};
