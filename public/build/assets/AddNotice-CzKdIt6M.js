import{P as F}from"./PictureInput-CkvSAKg-.js";import{h as V}from"./moment-C5S46NFB.js";import L from"./Links-Xv_uKlSf.js";import{l as i,c as v,o as g,w as l,b as o,a as k,i as s,p as T,z as b,A as h,h as P}from"./app-BOimrL6G.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";V.locale("es");const j={components:{"picture-input":F,"links-component":L},name:"add-notice",data:()=>({content:"<h1>Some initial content</h1>",imageMiniatura:"",menu:!1,menu2:!1,valid:!0,lazy:!1,snackbar:!1,response:"",notice:{image:"",title:"",city:"",date:"",time:"",description:"",links:[]},titleRules:[e=>!!e||"El título es requerido"],cityRules:[e=>!!e||"La ciudad o lugar son requeridas"],dateRules:[e=>!!e||"La fecha es requerida"],timeRules:[e=>!!e||"La hora es requerida"],descriptionRules:[e=>!!e||"La descripción es requerida"],imageRules:[e=>!e||e.size<5e6||"El tamaño de la imagen debe ser inferior a 5 MB!"],customStrings:{upload:"<p> Su dispositivo no admite la carga de archivos. </p>",drag:"Arrastre una imagen o <br> haga clic aquí para seleccionar 😼",tap:"Toque aquí para seleccionar una foto <br> de su galería",change:"Cambiar",remove:"Eliminar",select:"Selecciona una foto",fileType:"Este tipo de archivo no es compatible."}}),methods:{customButtonClick(){alert(`You can custom the button and listen click event to do something...
你可以定义一些自定义按钮做你想做的事，如上传图片至第三方存储再插入内容区...等等`)},deleteAllItem(){this.$refs.linksComponents.deleteAllItem()},removeImage(){this.$refs.pictureInput.removeImage()},closeDialog(){this.$emit("closeDialog",!1)},onChange(e){console.log("New picture selected!"),e?(console.log("Picture loaded."),this.notice.image=this.$refs.pictureInput.file,console.log(this.$refs.pictureInput.file)):console.log("FileReader API not supported: use the <form>, Luke!")},savedNotice(e){this.$emit("addNotice",e)},addNotice(){let e=new FormData;e.append("image",this.notice.image),e.append("title",this.notice.title),e.append("city",this.notice.city),e.append("date",this.notice.date),e.append("time",this.notice.time),e.append("description",this.notice.description),e.append("links",this.notice.links),console.log(e),axios.post("/notices",e).then(t=>{let r=t.data;console.log("este es response",t.data),this.$swal("Agregada!","Su noticia ha sido agregada exitosamente!","success").then(d=>{this.savedNotice(r),this.notice.image="",this.notice.title="",this.notice.city="",this.notice.date="",this.notice.time="",this.notice.description="",this.notice.links=[],this.removeImage(),this.closeDialog(),this.reset()}),console.log(t.data)}).catch(t=>{console.log(t);const r=t.response.data.errors;let d="";for(var p in r)d+=p+": "+r[p]+`
 `;this.$swal("Error!",d,"error"),console.log(d)})},validate(){this.$refs.form.validate()&&this.addNotice()},reset(){this.$refs.form.reset()},resetValidation(){this.$refs.form.resetValidation()}},computed:{computedDateFormattedMomentjs(){return this.notice.date?V(this.notice.date).format("dddd, D MMMM YYYY"):""}}};function H(e,t,r,d,p,a){const y=i("v-icon"),m=i("v-btn"),C=i("v-toolbar-title"),_=i("v-toolbar-items"),w=i("v-toolbar"),R=i("picture-input"),u=i("v-col"),c=i("v-text-field"),$=i("v-date-picker"),f=i("v-menu"),I=i("v-time-picker"),N=i("v-row"),q=i("v-label"),D=i("vue-editor"),S=i("v-form"),z=i("links-component"),A=i("v-card-text"),M=i("v-card-actions"),U=i("v-container"),E=i("v-card");return g(),v(E,{class:"rounded-0"},{default:l(()=>[o(w,{dark:""},{default:l(()=>[o(m,{icon:"",dark:"",onClick:a.closeDialog},{default:l(()=>[o(y,null,{default:l(()=>t[12]||(t[12]=[s("mdi-close")])),_:1})]),_:1},8,["onClick"]),o(C,null,{default:l(()=>t[13]||(t[13]=[s("Registro de noticia")])),_:1}),t[15]||(t[15]=k("div",{class:"flex-grow-1"},null,-1)),o(_,null,{default:l(()=>[o(m,{text:"",disabled:!e.valid,class:"mr-4",onClick:a.validate},{default:l(()=>t[14]||(t[14]=[s(" Registrar ")])),_:1},8,["disabled","onClick"])]),_:1})]),_:1}),o(U,{fluid:""},{default:l(()=>[o(A,null,{default:l(()=>[o(S,{onSubmit:T(a.addNotice,["prevent"]),ref:"form",modelValue:e.valid,"onUpdate:modelValue":t[10]||(t[10]=n=>e.valid=n),"lazy-validation":e.lazy,enctype:"multipart/form-data"},{default:l(()=>[o(N,null,{default:l(()=>[o(u,{cols:"12"},{default:l(()=>[o(R,{crop:!1,width:e.$vuetify.breakpoint.xsOnly?300:1e3,height:e.$vuetify.breakpoint.xsOnly?200:300,zIndex:0,ref:"pictureInput",onChange:a.onChange,accept:"image/jpeg,image/png",removable:!0,"button-class":"v-btn v-btn--contained theme--light v-size--small info",removeButtonClass:"v-btn v-btn--contained theme--light v-size--small error",customStrings:e.customStrings},null,8,["width","height","onChange","customStrings"])]),_:1}),o(u,{cols:"12"},{default:l(()=>[o(c,{clearable:"",modelValue:e.notice.title,"onUpdate:modelValue":t[0]||(t[0]=n=>e.notice.title=n),rules:e.titleRules,label:"Título",required:""},null,8,["modelValue","rules"])]),_:1}),o(u,{sm:"4",cols:"12"},{default:l(()=>[o(c,{clearable:"",modelValue:e.notice.city,"onUpdate:modelValue":t[1]||(t[1]=n=>e.notice.city=n),rules:e.cityRules,label:"Ciudad o lugar",required:""},null,8,["modelValue","rules"])]),_:1}),o(u,{sm:"4",cols:"12"},{default:l(()=>[o(f,{modelValue:e.menu,"onUpdate:modelValue":t[4]||(t[4]=n=>e.menu=n),"close-on-content-click":!1,transition:"scale-transition","max-width":"290"},{activator:l(({on:n})=>[o(c,b({value:a.computedDateFormattedMomentjs,rules:e.dateRules,clearable:"",label:"Fecha",readonly:""},h(n)),null,16,["value","rules"])]),default:l(()=>[o($,{modelValue:e.notice.date,"onUpdate:modelValue":t[2]||(t[2]=n=>e.notice.date=n),onChange:t[3]||(t[3]=n=>e.menu=!1),locale:"es"},null,8,["modelValue"])]),_:1},8,["modelValue"])]),_:1}),o(u,{sm:"4",cols:"12"},{default:l(()=>[o(f,{ref:"menu",modelValue:e.menu2,"onUpdate:modelValue":t[8]||(t[8]=n=>e.menu2=n),"close-on-content-click":!1,"nudge-right":40,"return-value":e.notice.time,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"290px"},{activator:l(({on:n})=>[o(c,b({modelValue:e.notice.time,"onUpdate:modelValue":t[5]||(t[5]=B=>e.notice.time=B),label:"Hora",rules:e.timeRules,readonly:""},h(n)),null,16,["modelValue","rules"])]),default:l(()=>[e.menu2?(g(),v(I,{key:0,modelValue:e.notice.time,"onUpdate:modelValue":t[6]||(t[6]=n=>e.notice.time=n),"full-width":"","onClick:minute":t[7]||(t[7]=n=>e.$refs.menu.save(e.notice.time))},null,8,["modelValue"])):P("",!0)]),_:1},8,["modelValue","return-value"])]),_:1})]),_:1}),o(q,{for:"myTextEditor"},{default:l(()=>t[16]||(t[16]=[s("Descripción")])),_:1}),o(D,{ref:"myTextEditor",rules:e.descriptionRules,modelValue:e.notice.description,"onUpdate:modelValue":t[9]||(t[9]=n=>e.notice.description=n)},null,8,["rules","modelValue"])]),_:1},8,["onSubmit","modelValue","lazy-validation"]),o(z,{ref:"linksComponents",class:"mt-4",onAddLink:t[11]||(t[11]=n=>e.notice.links=n),link:e.notice.links},null,8,["link"])]),_:1}),o(M,null,{default:l(()=>[t[19]||(t[19]=k("div",{class:"flex-grow-1"},null,-1)),o(m,{color:"warning",class:"mr-4",onClick:a.reset},{default:l(()=>t[17]||(t[17]=[s(" Reset Form ")])),_:1},8,["onClick"]),o(m,{color:"success",disabled:!e.valid,class:"mr-4",onClick:a.validate},{default:l(()=>t[18]||(t[18]=[s(" Registrar ")])),_:1},8,["disabled","onClick"])]),_:1})]),_:1})]),_:1})}const W=Y(j,[["render",H]]);export{W as default};
